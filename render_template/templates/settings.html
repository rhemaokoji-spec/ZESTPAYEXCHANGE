<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - ZestPay</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-card: #1e1e1e;
            --bg-input: #2a2a2a;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --accent: #d4af37;
            --accent-hover: #b8860b;
            --danger: #ff4757;
            --warning: #ffa502;
            --success: #2ed573;
            --border: #333333;
            --shadow: rgba(0,0,0,0.4);
            --gradient: linear-gradient(135deg, #f4e4c1 0%, #b8860b 100%);
        }

        [data-theme="light"] {
            --bg-primary: #f8f9fa;
            --bg-secondary: #e9ecef;
            --bg-card: #ffffff;
            --bg-input: #f1f3f5;
            --text-primary: #212529;
            --text-secondary: #6c757d;
            --accent: #d4af37;
            --accent-hover: #b8860b;
            --danger: #ff4757;
            --warning: #ffa502;
            --success: #2ed573;
            --border: #dee2e6;
            --shadow: rgba(0,0,0,0.1);
            --gradient: linear-gradient(135deg, #f4e4c1 0%, #b8860b 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            transition: all 0.3s ease;
            position: relative;
            overflow-x: hidden;
        }

        /* Animated background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient);
            opacity: 0.05;
            z-index: -1;
            animation: gradientShift 15s ease infinite;
        }

        @keyframes gradientShift {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(180deg); }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInDown 0.6s ease;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .welcome {
            font-size: 32px;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 16px;
        }

        /* Settings menu cards */
        .menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            animation: fadeInUp 0.6s ease 0.2s both;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .menu .card {
            background-color: rgba(212, 175, 55, 0.1);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 10px 30px var(--shadow);
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }

        .menu .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: var(--accent);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .menu .card:hover::before {
            transform: scaleX(1);
        }

        .menu .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px var(--shadow);
            border-color: var(--accent);
        }

        .menu .card.danger {
            border-color: rgba(212, 175, 55, 0.3);
        }

        .menu .card.danger::before {
            background-color: rgba(212, 175, 55, 0.5);
        }

        .menu .card.danger:hover {
            border-color: var(--danger);
            box-shadow: 0 15px 40px rgba(255, 71, 87, 0.2);
        }

        .menu .card i {
            font-size: 36px;
            margin-bottom: 15px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: block;
            transition: transform 0.3s ease;
        }

        .menu .card.danger i {
            background: var(--danger);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .menu .card:hover i {
            transform: scale(1.1);
        }

        .menu .card h3 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .menu .card p {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Section detail card */
        .section {
            display: none;
            background: var(--bg-card);
            color: var(--text-secondary);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 15px 40px var(--shadow);
            max-width: 800px;
            margin: 0 auto;
            border: 1px solid var(--border);
            animation: slideIn 0.4s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .section h3 {
            margin-top: 0;
            color: var(--text-primary);
            font-size: 24px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section h3 i {
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .section.danger h3 i {
            background: var(--danger);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-primary);
            font-size: 14px;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: 10px;
            background: var(--bg-input);
            color: var(--text-primary);
            font-size: 15px;
            transition: all 0.3s ease;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
            background: var(--bg-card);
        }

        textarea {
            resize: vertical;
            min-height: 120px;
        }

        /* Password strength indicator */
        .password-strength {
            margin-top: 8px;
            height: 4px;
            background: var(--border);
            border-radius: 2px;
            overflow: hidden;
        }

        .password-strength-bar {
            height: 100%;
            width: 0;
            transition: all 0.3s ease;
            border-radius: 2px;
        }

        .strength-weak { background: var(--danger); width: 33%; }
        .strength-medium { background: var(--warning); width: 66%; }
        .strength-strong { background: var(--success); width: 100%; }

        .password-requirements {
            margin-top: 10px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .password-requirements li {
            margin-left: 20px;
            margin-top: 4px;
            transition: color 0.3s ease;
        }

        .password-requirements li.valid {
            color: var(--success);
        }

        /* Password wrapper with toggle */
        .password-wrapper {
            position: relative;
        }

        .password-wrapper input {
            padding-right: 50px;
        }

        .password-toggle {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: var(--text-secondary);
            transition: color 0.3s ease;
        }

        .password-toggle:hover {
            color: var(--accent);
        }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 15px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transition: left 0.5s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: transparent;
            border: 2px solid var(--border);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            border-color: var(--accent);
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.2);
        }

        .btn-danger {
            background: var(--danger);
        }

        .btn-danger:hover {
            background: #ff3838;
            box-shadow: 0 8px 20px rgba(255, 71, 87, 0.3);
        }

        /* Back button */
        .back {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 20px;
            color: var(--accent);
            cursor: pointer;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .back:hover {
            gap: 12px;
            color: var(--accent-hover);
        }

        /* Dashboard back button */
        .dashboard-back {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 30px;
            color: var(--accent);
            cursor: pointer;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 16px;
        }

        .dashboard-back:hover {
            gap: 12px;
            color: var(--accent-hover);
        }

        /* Checkbox styling */
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            cursor: pointer;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--accent);
        }

        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--bg-card);
            color: var(--text-primary);
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 10px 30px var(--shadow);
            transform: translateX(400px);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 12px;
            border-left: 4px solid var(--accent);
            max-width: 350px;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast.success { border-left-color: var(--success); }
        .toast.error { border-left-color: var(--danger); }
        .toast.warning { border-left-color: var(--warning); }

        .toast i {
            font-size: 20px;
        }

        .toast.success i { color: var(--success); }
        .toast.error i { color: var(--danger); }
        .toast.warning i { color: var(--warning); }

        /* Loading spinner */
        .spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Two-factor setup */
        .two-factor-setup {
            background: var(--bg-input);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .backup-codes {
            background: var(--bg-primary);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-family: monospace;
            font-size: 14px;
            line-height: 1.8;
        }

        /* Contact info cards */
        .contact-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .contact-info .info-card {
            background-color: rgba(212, 175, 55, 0.1);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .contact-info .info-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px var(--shadow);
        }

        .contact-info .info-card i {
            font-size: 30px;
            color: var(--accent);
            margin-bottom: 10px;
        }

        .contact-info .info-card h4 {
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .contact-info .info-card p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* OTP Input */
        .otp-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

        .otp-input {
            width: 50px;
            height: 50px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
        }

        /* Warning box */
        .warning-box {
            background: rgba(255, 71, 87, 0.1);
            border-left: 4px solid var(--danger);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .warning-box h4 {
            color: var(--danger);
            margin-bottom: 10px;
        }

        .warning-box p {
            color: var(--text-secondary);
        }

        /* Responsive */
        @media(max-width:768px){
            .container {
                padding: 20px 15px;
            }
            
            .menu {
                grid-template-columns: 1fr;
            }
            
            .section {
                padding: 25px;
            }
            
            .welcome {
                font-size: 24px;
                
            }
            
            .toast {
                right: 15px;
                left: 15px;
                max-width: none;
            }
            
            .otp-input {
                width: 40px;
                height: 40px;
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="welcome" id="welcomeMsg">Welcome</h1>
            <p class="subtitle" id="subtitle">Manage your account settings and preferences</p>
        </div>

        <!-- Main Menu -->
        <div id="menu" class="menu">
            <!-- Dashboard Back Button -->
            <a href="/dashboard" class="dashboard-back">
                <i class="fa fa-arrow-left"></i>
                <span data-i18n="dashboardBack">Back to Dashboard</span>
            </a>
            
            <div class="card" onclick="openSection('profile')">
                <i class="fa fa-user-circle"></i>
                <h3 data-i18n="menu.profile">Profile</h3>
                <p data-i18n="menu.profileDesc">Update your personal information</p>
            </div>
            <div class="card" onclick="openSection('password')">
                <i class="fa fa-lock"></i>
                <h3 data-i18n="menu.password">Password</h3>
                <p data-i18n="menu.passwordDesc">Change your password</p>
            </div>
            <div class="card" onclick="openSection('notify')">
                <i class="fa fa-bell"></i>
                <h3 data-i18n="menu.notifications">Notifications</h3>
                <p data-i18n="menu.notificationsDesc">Manage your alerts</p>
            </div>
            <div class="card" onclick="openSection('security')">
                <i class="fa fa-shield-halved"></i>
                <h3 data-i18n="menu.security">Security</h3>
                <p data-i18n="menu.securityDesc">Protect your account</p>
            </div>
            <div class="card" onclick="openSection('contact')">
                <i class="fa fa-envelope"></i>
                <h3 data-i18n="menu.contact">Contact Us</h3>
                <p data-i18n="menu.contactDesc">Get in touch with support</p>
            </div>
            <div class="card danger" onclick="openSection('delete')">
                <i class="fa fa-trash-alt"></i>
                <h3 data-i18n="menu.delete">Delete Account</h3>
                <p data-i18n="menu.deleteDesc">Permanently delete your account</p>
            </div>
        </div>

        <!-- Profile Section -->
        <div id="profile" class="section">
            <a class="back" onclick="goBack()">
                <i class="fa fa-arrow-left"></i>
                <span data-i18n="back">Back</span>
            </a>
            <h3><i class="fa fa-user-circle"></i> <span data-i18n="profile.title">Edit Profile</span></h3>
            
            <div class="form-group">
                <label data-i18n="profile.firstName">First Name</label>
                <input id="firstName" type="text">
            </div>
            
            <div class="form-group">
                <label data-i18n="profile.lastName">Last Name</label>
                <input id="lastName" type="text">
            </div>
            
            <div class="form-group">
                <label data-i18n="profile.phone">Phone Number</label>
                <input id="phone" type="tel">
            </div>
            
            <div class="form-group">
                <label data-i18n="profile.email">Email Address</label>
                <input id="email" type="email">
            </div>
            
            <button class="btn" onclick="saveProfile()">
                <i class="fa fa-save"></i> <span data-i18n="profile.save">Save Changes</span>
            </button>
        </div>

        <!-- Password Section -->
        <div id="password" class="section">
            <a class="back" onclick="goBack()">
                <i class="fa fa-arrow-left"></i>
                <span data-i18n="back">Back</span>
            </a>
            <h3><i class="fa fa-lock"></i> <span data-i18n="password.title">Change Password</span></h3>
            
            <div class="form-group">
                <label data-i18n="password.current">Current Password</label>
                <div class="password-wrapper">
                    <input id="currentPass" type="password">
                    <i class="fa fa-eye password-toggle" onclick="togglePass('currentPass', this)"></i>
                </div>
            </div>
            
            <div class="form-group">
                <label data-i18n="password.new">New Password</label>
                <div class="password-wrapper">
                    <input id="newPass" type="password" oninput="checkPasswordStrength()">
                    <i class="fa fa-eye password-toggle" onclick="togglePass('newPass', this)"></i>
                </div>
                <div class="password-strength">
                    <div class="password-strength-bar" id="strengthBar"></div>
                </div>
                <ul class="password-requirements" id="passwordRequirements">
                    <li data-i18n="password.req.length">At least 8 characters</li>
                    <li data-i18n="password.req.upper">One uppercase letter</li>
                    <li data-i18n="password.req.lower">One lowercase letter</li>
                    <li data-i18n="password.req.number">One number</li>
                    <li data-i18n="password.req.special">One special character</li>
                </ul>
            </div>
            
            <div class="form-group">
                <label data-i18n="password.confirm">Confirm New Password</label>
                <div class="password-wrapper">
                    <input id="confirmPass" type="password" oninput="checkPasswordMatch()">
                    <i class="fa fa-eye password-toggle" onclick="togglePass('confirmPass', this)"></i>
                </div>
            </div>
            
            <button class="btn" onclick="savePassword()">
                <i class="fa fa-key"></i> <span data-i18n="password.update">Update Password</span>
            </button>
        </div>

        <!-- Notifications Section -->
        <div id="notify" class="section">
            <a class="back" onclick="goBack()">
                <i class="fa fa-arrow-left"></i>
                <span data-i18n="back">Back</span>
            </a>
            <h3><i class="fa fa-bell"></i> <span data-i18n="notifications.title">Notification Settings</span></h3>
            
            <label class="checkbox-group">
                <input type="checkbox" id="notifyEmail">
                <span data-i18n="notifications.email">Email Notifications</span>
            </label>
            
            <label class="checkbox-group">
                <input type="checkbox" id="notifySMS">
                <span data-i18n="notifications.sms">SMS Notifications</span>
            </label>
            
            <label class="checkbox-group">
                <input type="checkbox" id="notifyPush">
                <span data-i18n="notifications.push">Push Notifications</span>
            </label>
            
            <button class="btn" onclick="saveNotify()">
                <i class="fa fa-save"></i> <span data-i18n="save">Save Settings</span>
            </button>
        </div>

        <!-- Security Section -->
        <div id="security" class="section">
            <a class="back" onclick="goBack()">
                <i class="fa fa-arrow-left"></i>
                <span data-i18n="back">Back</span>
            </a>
            <h3><i class="fa fa-shield-halved"></i> <span data-i18n="security.title">Security Settings</span></h3>
            
            <label class="checkbox-group">
                <input type="checkbox" id="twoFA" onchange="toggleTwoFA()">
                <span data-i18n="security.twoFA">Two-Factor Authentication</span>
            </label>
            
            <div id="twoFASetup" class="two-factor-setup" style="display: none;">
                <h4 data-i18n="security.setup">Setup Two-Factor Authentication</h4>
                <p data-i18n="security.backup">Save these backup codes:</p>
                <div class="backup-codes">
                    1234-5678-9012<br>
                    3456-7890-1234<br>
                    5678-9012-3456<br>
                    7890-1234-5678<br>
                    9012-3456-7890
                </div>
            </div>
            
            <label class="checkbox-group">
                <input type="checkbox" id="sessionTimeout">
                <span data-i18n="security.timeout">Session Timeout (30 min)</span>
            </label>
            
            <button class="btn" onclick="saveSecurity()">
                <i class="fa fa-shield-halved"></i> <span data-i18n="save">Save Settings</span>
            </button>
        </div>

        <!-- Contact Us Section -->
        <div id="contact" class="section">
            <a class="back" onclick="goBack()">
                <i class="fa fa-arrow-left"></i>
                <span data-i18n="back">Back</span>
            </a>
            <h3><i class="fa fa-envelope"></i> <span data-i18n="contact.title">Contact Us</span></h3>
            
            <p style="margin-bottom: 20px; color: var(--text-secondary);" data-i18n="contact.subtitle">
                We're here to help! Send us a message and we'll get back to you as soon as possible.
            </p>
            
            <div class="form-group">
                <label data-i18n="contact.name">Your Name</label>
                <input id="contactName" type="text" placeholder="Enter your full name">
            </div>
            
            <div class="form-group">
                <label data-i18n="contact.email">Your Email</label>
                <input id="contactEmail" type="email" placeholder="Enter your email address">
            </div>
            
            <div class="form-group">
                <label data-i18n="contact.subject">Subject</label>
                <select id="contactSubject">
                    <option value="general" data-i18n="contact.subjects.general">General Inquiry</option>
                    <option value="support" data-i18n="contact.subjects.support">Technical Support</option>
                    <option value="billing" data-i18n="contact.subjects.billing">Billing Question</option>
                    <option value="feedback" data-i18n="contact.subjects.feedback">Feedback</option>
                    <option value="partnership" data-i18n="contact.subjects.partnership">Partnership</option>
                </select>
            </div>
            
            <div class="form-group">
                <label data-i18n="contact.message">Message</label>
                <textarea id="contactMessage" placeholder="Describe your issue or question in detail..."></textarea>
            </div>
            
            <button class="btn" onclick="sendContactMessage()">
                <i class="fa fa-paper-plane"></i> <span data-i18n="contact.send">Send Message</span>
            </button>
            
            <div class="contact-info">
                <div class="info-card">
                    <i class="fa fa-envelope"></i>
                    <h4 data-i18n="contact.info.email">Email</h4>
                    <p>support@zestpay.com</p>
                </div>
                <div class="info-card">
                    <i class="fa fa-phone"></i>
                    <h4 data-i18n="contact.info.phone">Phone</h4>
                    <p>+234 802 654 4598</p>
                </div>
                <div class="info-card">
                    <i class="fa fa-clock"></i>
                    <h4 data-i18n="contact.info.hours">Hours</h4>
                    <p>24/7 Support</p>
                </div>
            </div>
        </div>

        <!-- Delete Account Section -->
        <div id="delete" class="section danger">
            <a class="back" onclick="goBack()">
                <i class="fa fa-arrow-left"></i>
                <span data-i18n="back">Back</span>
            </a>
            <h3><i class="fa fa-trash-alt"></i> <span data-i18n="delete.title">Delete Account</span></h3>
            
            <div class="warning-box">
                <h4 data-i18n="delete.warning.title">Warning: This action cannot be undone!</h4>
                <p data-i18n="delete.warning.text">Deleting your account will permanently remove all your data, including transactions, settings, and personal information. You will not be able to recover this information.</p>
            </div>
            
            <div id="deleteStep1">
                <p data-i18n="delete.step1.text">You are about to delete your account. This action is permanent and cannot be undone.</p>
                <button class="btn btn-danger" onclick="requestDeleteOTP()">
                    <i class="fa fa-exclamation-triangle"></i> <span data-i18n="delete.step1.button">Continue to Delete Account</span>
                </button>
            </div>
            
            <div id="deleteStep2" style="display: none;">
                <p data-i18n="delete.step2.text">We've sent a verification code to your email. Please enter it below to confirm account deletion.</p>
                <div class="otp-container">
                    <input type="text" class="otp-input" maxlength="1" id="otp1" onkeyup="moveToNext(this, 'otp2')">
                    <input type="text" class="otp-input" maxlength="1" id="otp2" onkeyup="moveToNext(this, 'otp3')">
                    <input type="text" class="otp-input" maxlength="1" id="otp3" onkeyup="moveToNext(this, 'otp4')">
                    <input type="text" class="otp-input" maxlength="1" id="otp4" onkeyup="moveToNext(this, 'otp5')">
                    <input type="text" class="otp-input" maxlength="1" id="otp5" onkeyup="moveToNext(this, 'otp6')">
                    <input type="text" class="otp-input" maxlength="1" id="otp6" onkeyup="moveToNext(this, '')">
                </div>
                <button class="btn btn-danger" onclick="verifyDeleteOTP()">
                    <i class="fa fa-trash-alt"></i> <span data-i18n="delete.step2.button">Delete My Account</span>
                </button>
                <button class="btn btn-secondary" onclick="resendDeleteOTP()">
                    <i class="fa fa-redo"></i> <span data-i18n="delete.step2.resend">Resend Code</span>
                </button>
            </div>
            
            <div id="deleteStep3" style="display: none;">
                <p data-i18n="delete.step3.text">Your account deletion is in progress. You will be logged out shortly.</p>
                <div style="text-align: center; margin: 20px 0;">
                    <div class="spinner" style="width: 40px; height: 40px; border-width: 4px;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast notification -->
    <div id="toast" class="toast">
        <i class="fa fa-check-circle"></i>
        <span id="toastMessage"></span>
    </div>

    <script>
        // Translations
        const translations = {
            en: {
                welcome: "Welcome",
                subtitle: "Manage your account settings and preferences",
                back: "Back",
                dashboardBack: "Back to Dashboard",
                save: "Save",
                menu: {
                    profile: "Profile",
                    profileDesc: "Update your personal information",
                    password: "Password",
                    passwordDesc: "Change your password",
                    notifications: "Notifications",
                    notificationsDesc: "Manage your alerts",
                    security: "Security",
                    securityDesc: "Protect your account",
                    contact: "Contact Us",
                    contactDesc: "Get in touch with support",
                    delete: "Delete Account",
                    deleteDesc: "Permanently delete your account"
                },
                profile: {
                    title: "Edit Profile",
                    firstName: "First Name",
                    lastName: "Last Name",
                    phone: "Phone Number",
                    email: "Email Address",
                    save: "Save Changes"
                },
                password: {
                    title: "Change Password",
                    current: "Current Password",
                    new: "New Password",
                    confirm: "Confirm New Password",
                    update: "Update Password",
                    req: {
                        length: "At least 8 characters",
                        upper: "One uppercase letter",
                        lower: "One lowercase letter",
                        number: "One number",
                        special: "One special character"
                    }
                },
                notifications: {
                    title: "Notification Settings",
                    email: "Email Notifications",
                    sms: "SMS Notifications",
                    push: "Push Notifications"
                },
                security: {
                    title: "Security Settings",
                    twoFA: "Two-Factor Authentication",
                    setup: "Setup Two-Factor Authentication",
                    backup: "Save these backup codes:",
                    timeout: "Session Timeout (30 min)"
                },
                contact: {
                    title: "Contact Us",
                    subtitle: "We're here to help! Send us a message and we'll get back to you as soon as possible.",
                    name: "Your Name",
                    email: "Your Email",
                    subject: "Subject",
                    message: "Message",
                    send: "Send Message",
                    subjects: {
                        general: "General Inquiry",
                        support: "Technical Support",
                        billing: "Billing Question",
                        feedback: "Feedback",
                        partnership: "Partnership"
                    },
                    info: {
                        email: "Email",
                        phone: "Phone",
                        hours: "Hours"
                    }
                },
                delete: {
                    title: "Delete Account",
                    warning: {
                        title: "Warning: This action cannot be undone!",
                        text: "Deleting your account will permanently remove all your data, including transactions, settings, and personal information. You will not be able to recover this information."
                    },
                    step1: {
                        text: "You are about to delete your account. This action is permanent and cannot be undone.",
                        button: "Continue to Delete Account"
                    },
                    step2: {
                        text: "We've sent a verification code to your email. Please enter it below to confirm account deletion.",
                        button: "Delete My Account",
                        resend: "Resend Code"
                    },
                    step3: {
                        text: "Your account deletion is in progress. You will be logged out shortly."
                    }
                },
                messages: {
                    profileUpdated: "Profile updated successfully",
                    passwordUpdated: "Password updated successfully",
                    notificationsUpdated: "Notification settings updated",
                    securityUpdated: "Security settings updated",
                    contactSent: "Message sent successfully! We'll get back to you soon.",
                    error: "Error occurred",
                    passwordMismatch: "Passwords do not match",
                    passwordWeak: "Password is too weak",
                    currentPasswordRequired: "Current password is required",
                    twoFAEnabled: "Two-factor authentication enabled",
                    twoFADisabled: "Two-factor authentication disabled",
                    contactFieldsRequired: "Please fill in all required fields",
                    contactEmailInvalid: "Please enter a valid email address",
                    contactMessageTooShort: "Message must be at least 10 characters long",
                    deleteOTPSent: "Verification code sent to your email",
                    deleteOTPInvalid: "Invalid verification code",
                    deleteSuccess: "Account deleted successfully",
                    deleteError: "Failed to delete account"
                }
            },
            fr: {
                welcome: "Bienvenue",
                subtitle: "Gérez vos paramètres de compte et vos préférences",
                back: "Retour",
                dashboardBack: "Retour au tableau de bord",
                save: "Enregistrer",
                menu: {
                    profile: "Profil",
                    profileDesc: "Mettez à jour vos informations personnelles",
                    password: "Mot de passe",
                    passwordDesc: "Changez votre mot de passe",
                    notifications: "Notifications",
                    notificationsDesc: "Gérez vos alertes",
                    security: "Sécurité",
                    securityDesc: "Protégez votre compte",
                    contact: "Nous Contacter",
                    contactDesc: "Contactez le support",
                    delete: "Supprimer le compte",
                    deleteDesc: "Supprimer définitivement votre compte"
                },
                profile: {
                    title: "Modifier le profil",
                    firstName: "Prénom",
                    lastName: "Nom de famille",
                    phone: "Numéro de téléphone",
                    email: "Adresse e-mail",
                    save: "Enregistrer les modifications"
                },
                password: {
                    title: "Changer le mot de passe",
                    current: "Mot de passe actuel",
                    new: "Nouveau mot de passe",
                    confirm: "Confirmer le nouveau mot de passe",
                    update: "Mettre à jour le mot de passe",
                    req: {
                        length: "Au moins 8 caractères",
                        upper: "Une lettre majuscule",
                        lower: "Une lettre minuscule",
                        number: "Un chiffre",
                        special: "Un caractère spécial"
                    }
                },
                notifications: {
                    title: "Paramètres de notification",
                    email: "Notifications par e-mail",
                    sms: "Notifications SMS",
                    push: "Notifications push"
                },
                security: {
                    title: "Paramètres de sécurité",
                    twoFA: "Authentification à deux facteurs",
                    setup: "Configurer l'authentification à deux facteurs",
                    backup: "Enregistrez ces codes de sauvegarde :",
                    timeout: "Délai d'expiration de session (30 min)"
                },
                contact: {
                    title: "Nous Contacter",
                    subtitle: "Nous sommes là pour vous aider! Envoyez-nous un message et nous vous répondrons dès que possible.",
                    name: "Votre Nom",
                    email: "Votre Email",
                    subject: "Sujet",
                    message: "Message",
                    send: "Envoyer le Message",
                    subjects: {
                        general: "Demande Générale",
                        support: "Support Technique",
                        billing: "Question de Facturation",
                        feedback: "Commentaires",
                        partnership: "Partenariat"
                    },
                    info: {
                        email: "Email",
                        phone: "Téléphone",
                        hours: "Heures"
                    }
                },
                delete: {
                    title: "Supprimer le compte",
                    warning: {
                        title: "Attention : Cette action ne peut pas être annulée !",
                        text: "La suppression de votre compte supprimera définitivement toutes vos données, y compris les transactions, les paramètres et les informations personnelles. Vous ne pourrez pas récupérer ces informations."
                    },
                    step1: {
                        text: "Vous êtes sur le point de supprimer votre compte. Cette action est permanente et ne peut pas être annulée.",
                        button: "Continuer à supprimer le compte"
                    },
                    step2: {
                        text: "Nous avons envoyé un code de vérification à votre e-mail. Veuillez le saisir ci-dessous pour confirmer la suppression du compte.",
                        button: "Supprimer mon compte",
                        resend: "Renvoyer le code"
                    },
                    step3: {
                        text: "La suppression de votre compte est en cours. Vous serez déconnecté sous peu."
                    }
                },
                messages: {
                    profileUpdated: "Profil mis à jour avec succès",
                    passwordUpdated: "Mot de passe mis à jour avec succès",
                    notificationsUpdated: "Paramètres de notification mis à jour",
                    securityUpdated: "Paramètres de sécurité mis à jour",
                    contactSent: "Message envoyé avec succès! Nous vous répondrons bientôt.",
                    error: "Une erreur est survenue",
                    passwordMismatch: "Les mots de passe ne correspondent pas",
                    passwordWeak: "Le mot de passe est trop faible",
                    currentPasswordRequired: "Le mot de passe actuel est requis",
                    twoFAEnabled: "Authentification à deux facteurs activée",
                    twoFADisabled: "Authentification à deux facteurs désactivée",
                    contactFieldsRequired: "Veuillez remplir tous les champs obligatoires",
                    contactEmailInvalid: "Veuillez entrer une adresse e-mail valide",
                    contactMessageTooShort: "Le message doit contenir au moins 10 caractères",
                    deleteOTPSent: "Code de vérification envoyé à votre e-mail",
                    deleteOTPInvalid: "Code de vérification invalide",
                    deleteSuccess: "Compte supprimé avec succès",
                    deleteError: "Échec de la suppression du compte"
                }
            }
        };

        // Current language
        let currentLang = localStorage.getItem('zestpay_lang') || 'en';

        // Apply theme
        function applyTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('zestpay_theme', theme);
        }

        // Apply language
        function applyLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('zestpay_lang', lang);
            
            // Update all elements with data-i18n attribute
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const keys = element.getAttribute('data-i18n').split('.');
                let translation = translations[lang];
                
                for (const key of keys) {
                    translation = translation[key];
                }
                
                if (translation) {
                    element.textContent = translation;
                }
            });
            
            // Update placeholders
            updatePlaceholders();
            
            // Update welcome message
            updateWelcomeMessage();
        }

        // Update placeholders based on language
        function updatePlaceholders() {
            const placeholders = {
                currentPass: currentLang === 'fr' ? 'Mot de passe actuel' : 'Current Password',
                newPass: currentLang === 'fr' ? 'Nouveau mot de passe' : 'New Password',
                confirmPass: currentLang === 'fr' ? 'Confirmer le mot de passe' : 'Confirm New Password',
                contactName: currentLang === 'fr' ? 'Entrez votre nom complet' : 'Enter your full name',
                contactEmail: currentLang === 'fr' ? 'Entrez votre adresse e-mail' : 'Enter your email address',
                contactMessage: currentLang === 'fr' ? 'Décrivez votre problème ou question en détail...' : 'Describe your issue or question in detail...'
            };
            
            Object.keys(placeholders).forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.placeholder = placeholders[id];
                }
            });
        }

        // Update welcome message
        function updateWelcomeMessage() {
            const firstName = document.getElementById('firstName').value;
            document.getElementById('welcomeMsg').textContent = 
                `${translations[currentLang].welcome}, ${firstName || (currentLang === 'fr' ? 'Utilisateur' : 'User')}`;
            document.getElementById('subtitle').textContent = translations[currentLang].subtitle;
        }

        // Show toast notification
        function showToast(message, type = 'success', duration = 4000) {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            const icon = toast.querySelector('i');
            
            // Set message
            toastMessage.textContent = message;
            
            // Set icon and class based on type
            toast.className = 'toast ' + type;
            if (type === 'success') {
                icon.className = 'fa fa-check-circle';
            } else if (type === 'error') {
                icon.className = 'fa fa-exclamation-circle';
            } else if (type === 'warning') {
                icon.className = 'fa fa-exclamation-triangle';
            }
            
            // Show toast
            toast.classList.add('show');
            
            // Hide after duration
            setTimeout(() => {
                toast.classList.remove('show');
            }, duration);
        }

        // Open/close sections
        function openSection(id){
            document.getElementById("menu").style.display="none";
            document.getElementById(id).style.display="block";
        }

        function goBack(){
            document.querySelectorAll('.section').forEach(s=>s.style.display="none");
            document.getElementById("menu").style.display="grid";
        }

        // Toggle password visibility
        function togglePass(id, el){
            const input = document.getElementById(id);
            if(input.type === "password"){
                input.type = "text";
                el.classList.remove("fa-eye");
                el.classList.add("fa-eye-slash");
            } else {
                input.type = "password";
                el.classList.remove("fa-eye-slash");
                el.classList.add("fa-eye");
            }
        }

        // Check password strength
        function checkPasswordStrength() {
            const password = document.getElementById('newPass').value;
            const strengthBar = document.getElementById('strengthBar');
            const requirements = document.getElementById('passwordRequirements').children;
            
            let strength = 0;
            const checks = [
                password.length >= 8,
                /[A-Z]/.test(password),
                /[a-z]/.test(password),
                /[0-9]/.test(password),
                /[^A-Za-z0-9]/.test(password)
            ];
            
            // Update requirement indicators
            checks.forEach((check, index) => {
                if (check) {
                    requirements[index].classList.add('valid');
                    strength++;
                } else {
                    requirements[index].classList.remove('valid');
                }
            });
            
            // Update strength bar
            strengthBar.className = 'password-strength-bar';
            if (password.length > 0) {
                if (strength <= 2) {
                    strengthBar.classList.add('strength-weak');
                } else if (strength <= 4) {
                    strengthBar.classList.add('strength-medium');
                } else {
                    strengthBar.classList.add('strength-strong');
                }
            }
        }

        // Check password match
        function checkPasswordMatch() {
            const newPass = document.getElementById('newPass').value;
            const confirmPass = document.getElementById('confirmPass').value;
            const confirmInput = document.getElementById('confirmPass');
            
            if (confirmPass.length > 0) {
                if (newPass === confirmPass) {
                    confirmInput.style.borderColor = 'var(--success)';
                } else {
                    confirmInput.style.borderColor = 'var(--danger)';
                }
            } else {
                confirmInput.style.borderColor = 'var(--border)';
            }
        }

        // Toggle Two-Factor Authentication setup
        function toggleTwoFA() {
            const isChecked = document.getElementById('twoFA').checked;
            const setupDiv = document.getElementById('twoFASetup');
            
            if (isChecked) {
                setupDiv.style.display = 'block';
            } else {
                setupDiv.style.display = 'none';
            }
        }

        // OTP Input Navigation
        function moveToNext(current, nextFieldID) {
            if (current.value.length >= current.maxLength) {
                if (nextFieldID === '') {
                    // Last field, auto-submit
                    verifyDeleteOTP();
                } else {
                    document.getElementById(nextFieldID).focus();
                }
            }
        }

        // Request OTP for account deletion
        async function requestDeleteOTP() {
            try {
                const response = await fetch('/api/delete/request', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                const result = await response.json();
                
                if (result.status === 'ok') {
                    document.getElementById('deleteStep1').style.display = 'none';
                    document.getElementById('deleteStep2').style.display = 'block';
                    showToast(translations[currentLang].messages.deleteOTPSent, 'success');
                } else {
                    showToast(result.message || translations[currentLang].messages.error, 'error');
                }
            } catch (error) {
                console.error('Error requesting delete OTP:', error);
                showToast(translations[currentLang].messages.error, 'error');
            }
        }

        // Resend OTP for account deletion
        async function resendDeleteOTP() {
            try {
                const response = await fetch('/api/delete/resend', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                const result = await response.json();
                
                if (result.status === 'ok') {
                    showToast(translations[currentLang].messages.deleteOTPSent, 'success');
                } else {
                    showToast(result.message || translations[currentLang].messages.error, 'error');
                }
            } catch (error) {
                console.error('Error resending delete OTP:', error);
                showToast(translations[currentLang].messages.error, 'error');
            }
        }

        // Verify OTP and delete account
        async function verifyDeleteOTP() {
            const otp = 
                document.getElementById('otp1').value +
                document.getElementById('otp2').value +
                document.getElementById('otp3').value +
                document.getElementById('otp4').value +
                document.getElementById('otp5').value +
                document.getElementById('otp6').value;
            
            if (otp.length !== 6) {
                showToast(translations[currentLang].messages.deleteOTPInvalid, 'error');
                return;
            }
            
            try {
                document.getElementById('deleteStep2').style.display = 'none';
                document.getElementById('deleteStep3').style.display = 'block';
                
                const response = await fetch('/api/delete/verify', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ otp: otp })
                });
                
                const result = await response.json();
                
                if (result.status === 'ok') {
                    showToast(translations[currentLang].messages.deleteSuccess, 'success');
                    
                    // Redirect to login page after a delay
                    setTimeout(() => {
                        window.location.href = '/login';
                    }, 3000);
                } else {
                    // Go back to step 2 if there's an error
                    document.getElementById('deleteStep3').style.display = 'none';
                    document.getElementById('deleteStep2').style.display = 'block';
                    showToast(result.message || translations[currentLang].messages.deleteOTPInvalid, 'error');
                }
            } catch (error) {
                console.error('Error verifying delete OTP:', error);
                // Go back to step 2 if there's an error
                document.getElementById('deleteStep3').style.display = 'none';
                document.getElementById('deleteStep2').style.display = 'block';
                showToast(translations[currentLang].messages.error, 'error');
            }
        }

        // API helper function
        async function apiCall(endpoint, method = 'GET', data = null) {
            const options = {
                method,
                headers: {
                    'Content-Type': 'application/json'
                }
            };
            
            if (data) {
                options.body = JSON.stringify(data);
            }
            
            try {
                const response = await fetch(endpoint, options);
                return await response.json();
            } catch (error) {
                console.error('API Error:', error);
                return { status: 'error', message: 'Network error' };
            }
        }

        // Load profile data
        async function loadProfile() {
            const result = await apiCall('/api/profile');
            if (result.status === 'ok') {
                const profile = result.profile;
                document.getElementById('firstName').value = profile.firstName || '';
                document.getElementById('lastName').value = profile.lastName || '';
                document.getElementById('phone').value = profile.phone || '';
                document.getElementById('email').value = profile.email || '';
                
                updateWelcomeMessage();
            }
        }

        // Load notification settings
        async function loadNotifications() {
            const result = await apiCall('/api/notify');
            if (result.status === 'ok') {
                const notifications = result.notifications;
                document.getElementById('notifyEmail').checked = notifications.email;
                document.getElementById('notifySMS').checked = notifications.sms;
                document.getElementById('notifyPush').checked = notifications.push;
            }
        }

        // Load security settings
        async function loadSecurity() {
            const result = await apiCall('/api/security');
            if (result.status === 'ok') {
                const security = result.security;
                document.getElementById('twoFA').checked = security.twoFA;
                document.getElementById('sessionTimeout').checked = security.sessionTimeout;
            }
        }

        // Save profile
        async function saveProfile() {
            const data = {
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value
            };
            
            const result = await apiCall('/api/profile', 'POST', data);
            if (result.status === 'ok') {
                showToast(translations[currentLang].messages.profileUpdated, 'success');
                updateWelcomeMessage();
            } else {
                showToast(result.message || translations[currentLang].messages.error, 'error');
            }
        }

        // Save password
        async function savePassword() {
            const currentPass = document.getElementById('currentPass').value;
            const newPass = document.getElementById('newPass').value;
            const confirmPass = document.getElementById('confirmPass').value;
            
            if (!currentPass) {
                showToast(translations[currentLang].messages.currentPasswordRequired, 'error');
                return;
            }
            
            if (newPass !== confirmPass) {
                showToast(translations[currentLang].messages.passwordMismatch, 'error');
                return;
            }
            
            // Check password strength
            const strengthBar = document.getElementById('strengthBar');
            if (strengthBar.classList.contains('strength-weak')) {
                showToast(translations[currentLang].messages.passwordWeak, 'warning');
                return;
            }
            
            const data = {
                currentPassword: currentPass,
                newPassword: newPass,
                confirmPassword: confirmPass
            };
            
            const result = await apiCall('/api/password', 'POST', data);
            if (result.status === 'ok') {
                showToast(translations[currentLang].messages.passwordUpdated, 'success');
                // Clear password fields
                document.getElementById('currentPass').value = '';
                document.getElementById('newPass').value = '';
                document.getElementById('confirmPass').value = '';
                document.getElementById('strengthBar').className = 'password-strength-bar';
                document.querySelectorAll('.password-requirements li').forEach(li => {
                    li.classList.remove('valid');
                });
            } else {
                showToast(result.message || translations[currentLang].messages.error, 'error');
            }
        }

        // Save notifications
        async function saveNotify() {
            const data = {
                email: document.getElementById('notifyEmail').checked,
                sms: document.getElementById('notifySMS').checked,
                push: document.getElementById('notifyPush').checked
            };
            
            const result = await apiCall('/api/notify', 'POST', data);
            if (result.status === 'ok') {
                showToast(translations[currentLang].messages.notificationsUpdated, 'success');
            } else {
                showToast(result.message || translations[currentLang].messages.error, 'error');
            }
        }

        // Save security settings
        async function saveSecurity() {
            const data = {
                twoFA: document.getElementById('twoFA').checked,
                sessionTimeout: document.getElementById('sessionTimeout').checked
            };
            
            const result = await apiCall('/api/security', 'POST', data);
            if (result.status === 'ok') {
                showToast(result.message || translations[currentLang].messages.securityUpdated, 'success');
            } else {
                showToast(result.message || translations[currentLang].messages.error, 'error');
            }
        }

        // Send contact message
        async function sendContactMessage() {
            const name = document.getElementById('contactName').value.trim();
            const email = document.getElementById('contactEmail').value.trim();
            const subject = document.getElementById('contactSubject').value;
            const message = document.getElementById('contactMessage').value.trim();
            
            // Validation
            if (!name || !email || !message) {
                showToast(translations[currentLang].messages.contactFieldsRequired, 'error');
                return;
            }
            
            // Email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showToast(translations[currentLang].messages.contactEmailInvalid, 'error');
                return;
            }
            
            // Message length validation
            if (message.length < 10) {
                showToast(translations[currentLang].messages.contactMessageTooShort, 'error');
                return;
            }
            
            const data = {
                name: name,
                email: email,
                subject: subject,
                message: message
            };
            
            const result = await apiCall('/send', 'POST', data);
            if (result.status === 'success' || result.status === 'ok') {
                showToast(translations[currentLang].messages.contactSent, 'success');
                // Clear form
                document.getElementById('contactName').value = '';
                document.getElementById('contactEmail').value = '';
                document.getElementById('contactSubject').value = 'general';
                document.getElementById('contactMessage').value = '';
            } else {
                showToast(result.msg || result.message || translations[currentLang].messages.error, 'error');
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Load all data
            loadProfile();
            loadNotifications();
            loadSecurity();
        });
    </script>
</body>
</html>